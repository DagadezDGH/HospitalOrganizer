CREATE DATABASE Hospitaldb;
USE Hospitaldb;

CREATE TABLE Proveedores(
 codProveedor CHAR(5) primary KEY,
 nombre VARCHAR(20),
 telefono CHAR(9));

CREATE TABLE Usuarios(
 dni CHAR(9) PRIMARY KEY,
 nombre VARCHAR(30),
 comprobar TinyInt,
 contraseña VARCHAR(20));

CREATE TABLE Articulos(
 codArticulo integer AUTO_INCREMENT PRIMARY KEY,
 nombre VARCHAR(20),
 descripcion VARCHAR(30),
 ubicacion VARCHAR(20),
 cantidad INTEGER);

CREATE TABLE Entradas(
 codEntrada INTEGER AUTO_INCREMENT PRIMARY KEY,
 codProveedor CHAR(5),
 dni CHAR(9),
 fechaEntrada DATE,
 comprobar TinyInt, 
 FOREIGN KEY (codProveedor) REFERENCES Proveedores(codProveedor),
 FOREIGN KEY (dni) REFERENCES Usuarios(dni));

CREATE TABLE Salidas(
 codSalida INTEGER AUTO_INCREMENT PRIMARY KEY,
 lugarSalida VARCHAR(20),
 motivoSalida VARCHAR(20),
 paciente VARCHAR(9),
 personal VARCHAR(9),
 fechaSalida DATE,
 comprobar TinyInt,
 FOREIGN KEY (paciente) REFERENCES Usuarios(dni),
 FOREIGN KEY (personal) REFERENCES Usuarios(dni));
 
CREATE TABLE SalidaArticulo(
 codSalidaArticulo integer AUTO_INCREMENT PRIMARY KEY,
 codArticulo INTEGER,  
 codSalida INTEGER,
 cantidadSalida INTEGER,
 FOREIGN KEY (codSalida) REFERENCES Salidas(codSalida),
 FOREIGN KEY (codArticulo) REFERENCES Articulos(codArticulo));

CREATE TABLE EntradaArticulo(
 codLote integer AUTO_INCREMENT PRIMARY KEY,
 codArticulo INTEGER,
 codEntrada INTEGER,
 cantidad INTEGER,
 caducidad DATE,
 FOREIGN KEY (codEntrada) REFERENCES Entradas(codEntrada),
 FOREIGN KEY (codArticulo) REFERENCES Articulos(codArticulo));


insert into Proveedores VALUES ('00005', 'Coca cola', '922001122');
insert into Proveedores VALUES ('00100', 'Calcedonia','900006699');
insert into Proveedores VALUES ('00010', 'Melocoton', '911001100');
insert into Proveedores VALUES ('10000', 'Melocoton', '911001100');

insert into Usuarios values ('12346677G', 'Thomas Muller', '0','gestorcomida');
insert into Usuarios values ('66511977G', 'Tom Crush', '0','gestorhigiene');

insert into Entradas VALUES (NULL, '00005','12346677G','2022-01-30', '1');

insert into Entradas VALUES (NULL, '00100', '66511977G','2022-01-30','1');

insert into Articulos VALUES (NULL, 'Coca cola','Refresco','Cocina', 40);
insert into Articulos VALUES (NULL, 'Fanta','Refresco','Cocina', 40);
insert into Articulos VALUES (NULL, 'Jugo de frutas','Jugo de frutas tropicales','Cocina', 40);
insert into Articulos VALUES (NULL, 'Guantes','Guantes de tejido magico','Higiene', 100);
insert into Articulos VALUES (NULL, 'Jabon','Jabon de manos','Higiene', 50);
insert into Articulos VALUES (NULL, 'Champú','Champú familiar','Higiene', 50);
insert into Articulos VALUES (NULL, 'Peluche','Oso de peluche','Ocio', 40);
insert into Articulos VALUES (NULL, 'KH7','Liquido fregasuelos','Higiene', 80);
insert into Articulos VALUES (NULL, 'Bisturi','Bisturi','Quirofano', 20);
insert into Articulos VALUES (NULL, 'Galletas de dinosaurios','Galletas de trigo','Cocina', 40);
insert into Articulos VALUES (NULL, 'Galletas de avena','Galletas de avena sin gluten','Cocina', 40);
insert into Articulos VALUES (NULL, 'Melocotones','Frutas','Cocina', 40);
insert into Articulos VALUES (NULL, 'Manzanas','Frutas','Cocina', 40);

insert into EntradaArticulo VALUES(NULL, 1,1, 20,'2022-02-28');
insert into EntradaArticulo VALUES(NULL, 1,1, 20,'2022-02-28');
insert into EntradaArticulo VALUES(NULL, 2,1, 20,'2022-02-28');
insert into EntradaArticulo VALUES(NULL, 3,1, 20,'2022-02-28');
insert into EntradaArticulo VALUES(NULL, 10,1, 20,'2022-02-28');
insert into EntradaArticulo VALUES(NULL, 11,1, 20,'2022-02-28');
insert into EntradaArticulo VALUES(NULL, 4,3, 20,'2022-06-28');
insert into EntradaArticulo VALUES(NULL, 6,3, 10,'2022-12-28');

insert into Salidas VALUES(NULL,'Cafeteria','No hay motivo',NULL,'12346677G','2022-01-30','0');
insert into Salidas VALUES(NULL,'Habitaciones','Repuestos',NULL,'66511977G','2022-01-30','0');

insert into SalidaArticulo VALUES(NULL, 1,1, 20);
insert into SalidaArticulo VALUES(NULL, 1,1, 20);
insert into SalidaArticulo VALUES(NULL, 2,1, 20);
insert into SalidaArticulo VALUES(NULL, 11,1, 20);
insert into SalidaArticulo VALUES(NULL, 10,1, 20);
insert into SalidaArticulo VALUES(NULL, 1,2, 20);
insert into SalidaArticulo VALUES(NULL, 5,2, 10);
insert into SalidaArticulo VALUES(NULL, 6,2, 20);
insert into SalidaArticulo VALUES(NULL, 8,2, 10);



//Estos no se meten por ahora

insert into Entradas VALUES (NULL, '00100','01745687F','2022-02-28','0');
insert into Entradas VALUES (NULL, '00010','01745687F', '2022-01-30','1');